!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.shortcodeTokenizer=t():e.shortcodeTokenizer=t()}(this,function(){return function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={exports:{},id:i,loaded:!1};return e[i].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e){return"/"===e[1]?l:"/"===e[e.length-2]?f:h}function r(e){return e=e.replace(/(^['"]|['"]$)/g,""),/^\d+$/.test(e)?+e:/^\d+.\d+$/.test(e)?parseFloat(e):/^(true|false|yes|no)$/i.test(e)?(e=e.toLowerCase(),"true"===e||"yes"===e):"undefined"===e?"undefined"==typeof thisIsNotDefined?"undefined":o(thisIsNotDefined):"null"===e?null:e}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u=t.TEXT="TEXT",a=t.ERROR="ERROR",h=t.OPEN="OPEN",l=t.CLOSE="CLOSE",f=t.SELF_CLOSING="SELF_CLOSING",c="[a-zA-Z][a-zA-Z0-9_-]*",p=c+"=\\d+\\.\\d+|"+c+"=\\d+|"+c+'="[^\\]"]*"|'+c+"='[^\\]']*'|"+c,y="(?:(?:"+p+")(?:(?!\\s+/?\\])\\s|))+",d="\\[\\/?[a-zA-Z][^\\]]+\\]",v="\\[("+c+")(\\s"+y+")?\\]",b="\\[("+c+")(\\s"+y+")?\\s?\\/\\]",x="\\[\\/("+c+")\\]",m=new RegExp(y.substring(0,y.length-1),"ig"),g=new RegExp(d,"i"),k=new RegExp(v,"i"),w=new RegExp(x,"i"),E=new RegExp(b,"i"),S=t.Token=function(){function e(t,i){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;n(this,e),this.name=null,this.type=t,this.body=i,this.pos=r,this.children=[],this.params={},this.isClosed=t===f,this.init()}return s(e,[{key:"init",value:function(){if(this.type!==u&&this.type!==a){var e=this.matchBody();this.initName(e),e[2]&&this.initParams(e[2])}}},{key:"initName",value:function(e){this.name=e[1]}},{key:"initParams",value:function(e){var t=e.match(m);this.params=t.reduce(function(e,t){t=t.trim();var n=t.indexOf("=");return~n?e[t.substring(0,n)]=r(t.substring(n+1)):e[t]=!0,e},{})}},{key:"matchBody",value:function(){var e=void 0;if(this.type===l)e=w;else if(this.type===h)e=k;else{if(this.type!==f)throw new SyntaxError("Unknown token: "+this.type);e=E}var t=this.body.match(e);if(null===t)throw new SyntaxError("Invalid "+this.type+" token: "+this.body);return t}},{key:"canClose",value:function(e){return this.name===e.name}}]),e}(),O=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];n(this,e),this.strict=i,this.buf=null,this.originalBuf=null,this.pos=0,t&&this.input(t)}return s(e,[{key:"input",value:function(e){if("string"!=typeof e)throw new Error("Invalid input");return this.buf=this.originalBuf=e,this.pos=0,this}},{key:"reset",value:function(){return this.buf=this.originalBuf,this.pos=0,this}},{key:"tokens",value:regeneratorRuntime.mark(function e(){var e,t,n,i,r,s,o,u=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(u&&this.input(u),"string"==typeof this.buf){a.next=3;break}throw new Error("Invalid input");case 3:e=[],t=void 0;case 5:if(null===(e=this._next())){a.next=35;break}e=Array.isArray(e)?e:[e],n=!0,i=!1,r=void 0,a.prev=10,s=e[Symbol.iterator]();case 12:if(n=(o=s.next()).done){a.next=19;break}return t=o.value,a.next=16,t;case 16:n=!0,a.next=12;break;case 19:a.next=25;break;case 21:a.prev=21,a.t0=a.catch(10),i=!0,r=a.t0;case 25:a.prev=25,a.prev=26,!n&&s.return&&s.return();case 28:if(a.prev=28,!i){a.next=31;break}throw r;case 31:return a.finish(28);case 32:return a.finish(25);case 33:a.next=5;break;case 35:case"end":return a.stop()}},e,this,[[10,21,25,33],[26,,28,32]])})},{key:"getTokens",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return Array.from(this.tokens(e))}},{key:"ast",value:function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=this.tokens(t),i=[],e=[],r=null,s=void 0,o=!0,c=!1,p=void 0;try{for(var y,d=n[Symbol.iterator]();!(o=(y=d.next()).done);o=!0)if(s=y.value,s.type===u)r?r.children.push(s):e.push(s);else if(s.type===h)r?(r.children.push(s),i.push(r),r=s):(r=s,e.push(r));else if(s.type===l)if(r&&s.canClose(r))r.isClosed=!0,r=i.pop();else{if(this.strict)throw new SyntaxError("Unmatched close token: "+s.body);var v=new S(a,s.body);r?r.children.push(v):e.push(v)}else{if(s.type!==f)throw new SyntaxError("Unknown token: "+s.type);r?r.children.push(s):e.push(s)}}catch(e){c=!0,p=e}finally{try{!o&&d.return&&d.return()}finally{if(c)throw p}}if(r){if(this.strict)throw new SyntaxError("Unmatched open token: "+r.body);e.push(new S(a,s.body))}return e}},{key:"_next",value:function(){if(!this.buf)return null;var e=this.buf.match(g);if(null===e){var t=new S(u,this.buf,this.pos);return this.pos+=this.buf.length,this.buf=null,t}var n=[];return 0!==e.index&&n.push(new S(u,this.buf.substring(0,e.index),this.pos)),n.push(new S(i(e[0]),e[0],this.pos+e.index)),this.buf=this.buf.substring(e.index+e[0].length),this.pos+=e.index+e[0].length,0===this.buf.length&&(this.buf=null),n}}]),e}();t.default=O,Object.assign(O,{TEXT:u,ERROR:a,OPEN:h,CLOSE:l,SELF_CLOSING:f,rxParams:m,rxEnclosure:g,rxOpen:k,rxClose:w,rxSelfclosing:E})}])});
//# sourceMappingURL=shortcode-tokenizer.min.js.map
